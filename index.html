<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Love Surprise Creator üíñ</title>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
body{
  margin:0;
  font-family:sans-serif;
  background:linear-gradient(135deg,#ff9a9e,#fecfef);
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

.box{
  background:white;
  padding:25px;
  border-radius:20px;
  width:90%;
  max-width:420px;
  box-shadow:0 10px 30px rgba(0,0,0,0.2);
}

textarea,input{
  width:100%;
  margin-top:10px;
  padding:10px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:14px;
}

button{
  margin-top:15px;
  padding:10px;
  width:100%;
  border:none;
  border-radius:10px;
  background:#ff4d6d;
  color:white;
  font-size:16px;
  cursor:pointer;
}

.story{
  white-space:pre-line;
  margin-top:15px;
  font-size:16px;
}

.hidden{ display:none; }
</style>
</head>
<body>

<!-- ‡∏´‡∏ô‡πâ‡∏≤ Creator -->
<div class="box" id="creator">
  <h2>üíñ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏û‡∏£‡∏™‡πå‡πÅ‡∏ü‡∏ô</h2>

  <textarea id="message" placeholder="‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡πÅ‡∏ü‡∏ô‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ..."></textarea>

  <input type="text" id="youtube" placeholder="‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå YouTube (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)">

  <input type="password" id="password" placeholder="‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">

  <button onclick="generateLink()">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå üíå</button>

  <textarea id="result" placeholder="‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ..." readonly></textarea>
</div>


<!-- ‡∏´‡∏ô‡πâ‡∏≤ Viewer -->
<div class="box hidden" id="viewer">
  <h2 id="title">üîê ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏Å‡πà‡∏≠‡∏ô</h2>

  <div id="lockBox">
    <input type="password" id="inputPass" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
    <button onclick="unlock()">‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π üíñ</button>
    <p id="error" style="color:red;"></p>
  </div>

  <div id="content" class="hidden">
    <div class="story" id="showMessage"></div>
    <div id="videoBox"></div>
  </div>
</div>

<script>

// =================== ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå ===================
function generateLink(){

  const message=document.getElementById("message").value.trim();
  const youtube=document.getElementById("youtube").value.trim();
  const password=document.getElementById("password").value.trim();

  if(message==="" || password===""){
    alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞ üíñ");
    return;
  }

  let youtubeID="";

  if(youtube){
    const regExp=/^(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/;
    const match=youtube.match(regExp);
    if(match && match[1]){
      youtubeID=match[1];
    }
  }

  const data={
    msg:message,
    yt:youtubeID,
    pass:password
  };

  const encoded=btoa(unescape(encodeURIComponent(JSON.stringify(data))));
  const link=window.location.href.split("?")[0] + "?data=" + encoded;

  document.getElementById("result").value=link;
}


// =================== ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå ===================
function getData(){
  const params=new URLSearchParams(window.location.search);
  const encoded=params.get("data");
  if(!encoded) return null;

  try{
    return JSON.parse(decodeURIComponent(escape(atob(encoded))));
  }catch{
    return null;
  }
}

const data=getData();

if(data){
  document.getElementById("creator").classList.add("hidden");
  document.getElementById("viewer").classList.remove("hidden");
}


// =================== ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å ===================
function unlock(){

  const input=document.getElementById("inputPass").value;

  if(input===data.pass){

    document.getElementById("lockBox").classList.add("hidden");
    document.getElementById("content").classList.remove("hidden");
    document.getElementById("title").innerText="üíñ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡πÄ‡∏ò‡∏≠ üíñ";
    document.getElementById("showMessage").innerText=data.msg;

    confetti({particleCount:200,spread:100});

    if(data.yt){
      document.getElementById("videoBox").innerHTML=
      `<iframe width="100%" height="200"
      src="https://www.youtube.com/embed/${data.yt}?autoplay=1"
      allow="autoplay"></iframe>`;
    }

  }else{
    document.getElementById("error").innerText="‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏¥‡∏î‡∏ô‡∏∞ üíî";
  }

}

</script>

</body>
</html>
